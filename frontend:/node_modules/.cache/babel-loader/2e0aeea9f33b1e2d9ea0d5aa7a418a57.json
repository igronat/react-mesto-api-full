{"ast":null,"code":"var _jsxFileName = \"/Users/TommyRadin/Desktop/\\u043C\\u043E\\u0438 \\u0432\\u0435\\u0431 \\u0440\\u0430\\u0437\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0438/mesto-react/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, createContext } from 'react';\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport PopupWithForm from './PopupWithForm';\nimport ImagePopup from './ImagePopup';\nimport api from '../utils/Api';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext.js';\nimport { EditProfilePopup } from './EditProfilePopup';\nimport { EditAvatarPopup } from './EditAvatarPopup';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [isEditProfilePopupOpen, setEditProfilePopupOpen] = useState(false);\n  const [isAddPlacePopupOpen, setAddPlacePopupOpen] = useState(false);\n  const [isEditAvatarPopupOpen, setEditAvatarPopupOpen] = useState(false);\n  const [selectedCard, setSelectedCard] = useState(null);\n  const [currentUser, setCurrentUser] = useState({\n    name: '',\n    about: ''\n  });\n  useEffect(() => {\n    // const handleEscClose = (e) => {\n    //   if (e.key === \"Escape\") {\n    //     closeAllPopups();\n    //   }\n    // };\n    // document.addEventListener(\"keydown\", handleEscClose);\n    // return () => document.removeEventListener(\"keydown\", handleEscClose);\n    api.getProfileInfo().then(user => {\n      setCurrentUser(user);\n    }).catch(err => console.log(`Ошибка профиля: ${err}`));\n  }, []);\n\n  const handleEditAvatarClick = () => {\n    setEditAvatarPopupOpen(true);\n  };\n\n  const handleEditProfileClick = () => {\n    setEditProfilePopupOpen(true);\n  };\n\n  const handleAddPlaceClick = () => {\n    setAddPlacePopupOpen(true);\n  };\n\n  const handleCardClick = card => {\n    setSelectedCard(card);\n  };\n\n  const closeAllPopups = () => {\n    setEditProfilePopupOpen(false);\n    setAddPlacePopupOpen(false);\n    setEditAvatarPopupOpen(false);\n    setSelectedCard(null);\n  };\n\n  const handleUpdateUser = user => {\n    api.editProfile(user).then(res => {\n      setCurrentUser(res);\n      setEditProfilePopupOpen(false);\n    }).catch(err => console.log(`Ошибка обновления профиля: ${err}`));\n  };\n\n  const handleUpdateAvatar = user => {\n    api.avatarProfile(user).then(res => {\n      setCurrentUser(res);\n      setEditAvatarPopupOpen(false);\n    }).catch(err => console.log(`Ошибка аватара: ${err}`));\n  };\n\n  useEffect(() => {\n    // api\n    // .getProfileInfo()\n    // .then((res) => {\n    //     setUserName(res.name);\n    //     setUserDescription(res.about);\n    //     setUserAvatar(res.avatar);\n    // })\n    // .catch(err => console.log(`Ошибка при обновлении профиля: ${err}`));\n    api.getInitialCards().then(res => {\n      setCards(res);\n    }).catch(err => console.log(`Ошибка при добавлении карточек: ${err}`));\n  }, []);\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id); // Отправляем запрос в API и получаем обновлённые данные карточки\n\n    api.changeLikeCardStatus(card._id, isLiked).then(newCard => {\n      setCards(state => state.map(c => c._id === card._id ? newCard : c));\n    });\n  }\n\n  ;\n\n  function handleCardDelete(card) {\n    // Снова проверяем, являемся ли мы владельцем текущей карточки\n    const isOwn = card.owner._id === currentUser._id; // Отправляем запрос в API и получаем обновлённые данные карточки\n\n    api.deleteCard(card._id, !isOwn).then(newCard => {\n      setCards(state => state.map(c => c._id === card._id ? newCard : c));\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n      value: currentUser,\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Main, {\n        onEditAvatar: handleEditAvatarClick,\n        onEditProfile: handleEditProfileClick,\n        onAddPlace: handleAddPlaceClick,\n        onCardClick: handleCardClick\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: isEditProfilePopupOpen,\n        onClose: closeAllPopups,\n        onUpdateUser: handleUpdateUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: isEditAvatarPopupOpen,\n        onClose: closeAllPopups,\n        onUpdateAvatar: handleUpdateAvatar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n        card: selectedCard,\n        onClose: closeAllPopups\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n\n_s(App, \"4XwRDySp5TT7ZxO9J0TJ6k4K+Bg=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/TommyRadin/Desktop/мои веб разработки/mesto-react/src/components/App.js"],"names":["React","useState","useEffect","createContext","Header","Main","Footer","PopupWithForm","ImagePopup","api","CurrentUserContext","EditProfilePopup","EditAvatarPopup","App","isEditProfilePopupOpen","setEditProfilePopupOpen","isAddPlacePopupOpen","setAddPlacePopupOpen","isEditAvatarPopupOpen","setEditAvatarPopupOpen","selectedCard","setSelectedCard","currentUser","setCurrentUser","name","about","getProfileInfo","then","user","catch","err","console","log","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleCardClick","card","closeAllPopups","handleUpdateUser","editProfile","res","handleUpdateAvatar","avatarProfile","getInitialCards","setCards","handleCardLike","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","state","map","c","handleCardDelete","isOwn","owner","deleteCard"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createContext } from 'react';\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport PopupWithForm from './PopupWithForm';\nimport ImagePopup from './ImagePopup';\nimport api from '../utils/Api';\nimport {CurrentUserContext} from '../contexts/CurrentUserContext.js';\nimport {EditProfilePopup} from './EditProfilePopup';\nimport {EditAvatarPopup} from './EditAvatarPopup';\n\n\nfunction App() {\n    const [isEditProfilePopupOpen, setEditProfilePopupOpen] = useState(false);\n    const [isAddPlacePopupOpen, setAddPlacePopupOpen] = useState(false);\n    const [isEditAvatarPopupOpen, setEditAvatarPopupOpen] = useState(false);\n    const [selectedCard, setSelectedCard] = useState(null);\n    const [currentUser, setCurrentUser] = useState({name: '', about: ''});\n\n    useEffect(() => {\n        // const handleEscClose = (e) => {\n        //   if (e.key === \"Escape\") {\n        //     closeAllPopups();\n        //   }\n        // };\n    \n        // document.addEventListener(\"keydown\", handleEscClose);\n    \n        // return () => document.removeEventListener(\"keydown\", handleEscClose);\n\n        api\n        .getProfileInfo()\n        .then((user) => {\n            setCurrentUser(user);\n            \n        })\n        .catch(err => console.log(`Ошибка профиля: ${err}`));\n\n        \n      }, []); \n\n    const handleEditAvatarClick = () => {\n        setEditAvatarPopupOpen(true);\n    };\n    const handleEditProfileClick = () => {\n        setEditProfilePopupOpen(true);\n    }\n    const handleAddPlaceClick= () => {\n        setAddPlacePopupOpen(true);\n    }\n    const handleCardClick = (card) => {\n        setSelectedCard(card);\n    }\n\n    const closeAllPopups = () => {\n        setEditProfilePopupOpen(false);\n        setAddPlacePopupOpen(false);\n        setEditAvatarPopupOpen(false);\n        setSelectedCard(null);\n    }\n\n    const handleUpdateUser = (user) => {\n        api\n        .editProfile(user)\n        .then(res => {\n            setCurrentUser(res);\n            setEditProfilePopupOpen(false);\n        \n        })\n        .catch(err => console.log(`Ошибка обновления профиля: ${err}`));\n    };\n\n    const handleUpdateAvatar = (user) => {\n        api\n        .avatarProfile(user)\n        .then((res) => {\n            setCurrentUser(res);\n            setEditAvatarPopupOpen(false);\n        })\n        .catch(err => console.log(`Ошибка аватара: ${err}`));\n    }\n\n    useEffect(() => {\n        // api\n        // .getProfileInfo()\n        // .then((res) => {\n        //     setUserName(res.name);\n        //     setUserDescription(res.about);\n        //     setUserAvatar(res.avatar);\n            \n        // })\n        // .catch(err => console.log(`Ошибка при обновлении профиля: ${err}`));\n\n        api\n        .getInitialCards()\n        .then((res) => {\n            setCards(res)\n            \n        })\n        .catch(err => console.log(`Ошибка при добавлении карточек: ${err}`))\n\n    }, []);\n\n    function handleCardLike(card) {\n        // Снова проверяем, есть ли уже лайк на этой карточке\n        const isLiked = card.likes.some(i => i._id === currentUser._id);\n        \n        // Отправляем запрос в API и получаем обновлённые данные карточки\n        api\n        .changeLikeCardStatus(card._id, isLiked)\n        .then((newCard) => {\n            setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n        });\n    };\n    \n    function handleCardDelete(card) {\n        // Снова проверяем, являемся ли мы владельцем текущей карточки\n        const isOwn = card.owner._id === currentUser._id;\n        \n        // Отправляем запрос в API и получаем обновлённые данные карточки\n        api\n        .deleteCard(card._id, !isOwn)\n        .then((newCard) => {\n            setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n        });\n    } \n\n\n    return (  \n        <>\n        <CurrentUserContext.Provider value={currentUser}>\n            <Header/>\n\n            <Main\n                onEditAvatar={handleEditAvatarClick}\n                onEditProfile={handleEditProfileClick}\n                onAddPlace={handleAddPlaceClick}\n                onCardClick={handleCardClick}\n            />\n\n            <Footer/>\n\n            <EditProfilePopup \n            isOpen={isEditProfilePopupOpen} \n            onClose={closeAllPopups}\n            onUpdateUser={handleUpdateUser} \n            /> \n\n            {/* <PopupWithForm\n                title='Новое место'\n                name='mesto'\n                children={\n                    <>\n                    <input id=\"nameMesto\" type=\"text\" className=\"popup__input popup__text popup__text_type_mesto\" name=\"mesto\" placeholder=\"Название\" required defaultValue=\"\" minLength=\"2\" maxLength=\"30\"/>\n                    <span id=\"nameMesto-error\" className=\"error\"></span>\n                    <input id=\"link\" type=\"url\" className=\"popup__input popup__text popup__text_type_link\" name=\"link\" placeholder=\"Ссылка на картинку\" required defaultValue=\"\"/>\n                    <span id=\"link-error\" className=\"error\"></span>\n                    </>\n                }\n                onClose={closeAllPopups}\n                isOpen={isAddPlacePopupOpen}\n            \n            />  */}\n\n            <EditAvatarPopup \n            isOpen={isEditAvatarPopupOpen} \n            onClose={closeAllPopups}\n            onUpdateAvatar={handleUpdateAvatar} \n            />\n\n            \n\n            <ImagePopup \n                card = {selectedCard}\n                onClose = {closeAllPopups}\n            \n            />\n        </CurrentUserContext.Provider>\n \n        </>\n    );\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}